<script type="module">
  import config from './config.js'

  import Element from './Element.js'

  const Galaxy = {}

  // Setup configuration
  Galaxy.config = config

  Galaxy.Element = Element

  // Element registry
  Galaxy.elements = new Map()

  Galaxy.register = async CustomElement => {
    if (typeof CustomElement.is === 'undefined') {
      throw new GalaxyError('Unknown element name')
    }

    try {
      customElements.define(CustomElement.is, CustomElement)
    } catch (e) {
      throw new GalaxyError(e.message)
    }

    // Await CE definition
    await customElements.whenDefined(CustomElement.is)

    // Local propietary registration
    Galaxy.elements.set(CustomElement.is, CustomElement)

    return CustomElement
  }

  window.Galaxy = Galaxy
</script>
